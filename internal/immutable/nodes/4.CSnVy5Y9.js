import{t as f,a as c,c as V}from"../chunks/B7V-whKc.js";import"../chunks/BW6EN79o.js";import{B as z,a0 as j,a3 as O,a4 as ee,a2 as te,Y as x,X as w,s as y,m as P,g as a,Z as o,W as k,n as ae,a1 as se,a5 as ie,a6 as W}from"../chunks/BIeHt8rZ.js";import{s as X,e as Y}from"../chunks/D4bqg6A1.js";import{i as Z}from"../chunks/DKlYyJzN.js";import{t as re,e as $,i as E,s as oe,a as b}from"../chunks/_fjmeoBt.js";import{b as ne}from"../chunks/BcAGQpdC.js";import{i as le}from"../chunks/DJF4X7OK.js";import{s as ve,a as de}from"../chunks/BSBo1yJd.js";import{o as ce,a as pe}from"../chunks/DtAfHwvy.js";import{s as fe}from"../chunks/Bde_f8Z_.js";function ue(l,u,L,C){var g=l.__style;if(z||g!==u){var s=re(u);(!z||s!==l.getAttribute("style"))&&(s==null?l.removeAttribute("style"):l.style.cssText=s),l.__style=u}return C}const ge=!0,Ae=Object.freeze(Object.defineProperty({__proto__:null,prerender:ge},Symbol.toStringTag,{value:"Module"}));var _e=f("<button> </button>"),he=f('<div><video autoplay playsinline="" class="rounded shadow transition-transform duration-300 cursor-pointer"></video></div>',2),me=f('<img class="h-24 rounded">'),xe=f('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),we=f('<div class="w-full flex flex-col gap-2 mt-6"></div>'),ye=f('<section class="flex flex-col items-center gap-4 p-4"><div class="flex flex-wrap justify-center gap-2"></div> <div class="flex items-center justify-between gap-4 p-4 text-lg rounded shadow"></div> <!></section>');function Le(l,u){j(u,!1);const[L,C]=ve(),g=()=>de(fe,"$scanner",L);let s=P([]),_=P([]),S=[];const F=e=>{e.rotation=(e.rotation+90)%360,y(s,[...a(s)])},q=async(e,t=3840,i=2160)=>{e.active||(e.landscape||([t,i]=[i,t]),e.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e.device.deviceId},width:{ideal:t},height:{ideal:i}},audio:!1}),e.active=!0,y(s,[...a(s)]),await W(),e.videoEl&&(e.videoEl.srcObject=e.stream))},G=async e=>{e.landscape&&e.active?(D(e),e.landscape=!1,await W(),await q(e)):e.active?(D(e),e.landscape=!0):await q(e),y(s,[...a(s)])},D=e=>{var t;(t=e.stream)==null||t.getTracks().forEach(i=>i.stop()),e.stream=null,e.active=!1,e.videoEl&&(e.videoEl.srcObject=null)},H=(e,t=0)=>"";ce(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),S=(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput"),y(s,S.map(t=>({device:t,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),pe(()=>{a(s).forEach(e=>D(e))}),O(()=>(g(),a(s),a(_)),()=>{if(g()){const e=a(s).filter(t=>t.active&&t.videoEl).map(t=>H(t.videoEl,t.rotation));y(_,[...a(_),{scan:g(),image:[...e]}])}}),ee(),le();var M=ye(),B=x(M);$(B,5,()=>a(s),E,(e,t)=>{var i=_e();let n;var v=x(i);o(i),k(h=>{n=oe(i,1,"px-4 py-2 rounded shadow transition",null,n,h),X(v,`${a(t).device.label||"Unnamed Camera"} ${a(t).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(t).active,"bg-gray-800":!a(t).active,"text-white":!0})],ae),Y("click",i,()=>G(a(t))),c(e,i)}),o(B);var I=w(B,2);$(I,5,()=>a(s),E,(e,t,i)=>{var n=V(),v=se(n);{var h=m=>{var d=he(),p=x(d);ne(p,(r,T)=>(T.videoEl=r,ie(()=>a(s))),r=>r==null?void 0:r.videoEl,()=>[a(t)]),o(d),k(()=>ue(p,`transform: rotate(${a(t).rotation??""}deg);`)),Y("click",p,()=>F(a(t))),c(m,d)};Z(v,m=>{a(t).active&&m(h)})}c(e,n)}),o(I);var J=w(I,2);{var K=e=>{var t=we();$(t,5,()=>[...a(_)].reverse(),E,(i,n,v)=>{let h=()=>a(n).scan,m=()=>a(n).image;var d=xe(),p=x(d);b(p,"aria-label",`Delete scan ${v+1}`);var r=w(p,2),T=x(r,!0);o(r);var U=w(r,2);$(U,5,m,E,(Q,R)=>{var A=me();b(A,"alt",`Capture ${v+1}`),k(()=>b(A,"src",a(R))),c(Q,A)}),o(U);var N=w(U,2);b(N,"aria-label",`Confirm scan ${v+1}`),o(d),k(()=>X(T,h())),c(i,d)}),o(t),c(e,t)};Z(J,e=>{a(_).length&&e(K)})}o(M),c(l,M),te(),C()}export{Le as component,Ae as universal};
