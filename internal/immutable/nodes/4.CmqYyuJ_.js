import{t as f,a as c,c as R}from"../chunks/B7V-whKc.js";import"../chunks/BW6EN79o.js";import{B as z,a0 as V,a3 as j,a4 as O,a2 as ee,Y as m,X as w,s as y,m as P,g as a,Z as o,W as k,n as te,a1 as ae,a5 as se,a6 as W}from"../chunks/BIeHt8rZ.js";import{s as X,e as Y}from"../chunks/D4bqg6A1.js";import{i as Z}from"../chunks/DKlYyJzN.js";import{t as ie,e as $,i as b,s as re,a as C}from"../chunks/_fjmeoBt.js";import{b as oe}from"../chunks/BcAGQpdC.js";import{i as ne}from"../chunks/DJF4X7OK.js";import{s as le,a as ve}from"../chunks/BSBo1yJd.js";import{o as de,a as ce}from"../chunks/DtAfHwvy.js";import{s as pe}from"../chunks/Bde_f8Z_.js";function fe(l,u,L,E){var g=l.__style;if(z||g!==u){var s=ie(u);(!z||s!==l.getAttribute("style"))&&(s==null?l.removeAttribute("style"):l.style.cssText=s),l.__style=u}return E}const ue=!0,Ae=Object.freeze(Object.defineProperty({__proto__:null,prerender:ue},Symbol.toStringTag,{value:"Module"}));var ge=f("<button> </button>"),_e=f('<div><video autoplay playsinline="" class="rounded shadow transition-transform duration-300 cursor-pointer"></video></div>',2),he=f('<img class="h-24 rounded">'),xe=f('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),me=f('<div class="w-full flex flex-col gap-2 mt-6"></div>'),we=f('<section class="flex flex-col items-center gap-4 p-4"><div class="flex flex-wrap justify-center gap-2"></div> <div class="flex items-center justify-between gap-4 p-4 text-lg rounded shadow"></div> <!></section>');function Ie(l,u){V(u,!1);const[L,E]=le(),g=()=>ve(pe,"$scanner",L);let s=P([]),_=P([]),S=[];const F=e=>{e.rotation=(e.rotation+90)%360,y(s,[...a(s)])},q=async(e,t=3840,i=2160)=>{e.active||(e.landscape||([t,i]=[i,t]),e.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e.device.deviceId},width:{ideal:t},height:{ideal:i}},audio:!1}),e.active=!0,y(s,[...a(s)]),await W(),e.videoEl&&(e.videoEl.srcObject=e.stream))},G=async e=>{e.landscape&&e.active?(D(e),e.landscape=!1,await W(),await q(e)):e.active?(D(e),e.landscape=!0):await q(e),y(s,[...a(s)])},D=e=>{var t;(t=e.stream)==null||t.getTracks().forEach(i=>i.stop()),e.stream=null,e.active=!1,e.videoEl&&(e.videoEl.srcObject=null)};de(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),S=(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput"),y(s,S.map(t=>({device:t,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),ce(()=>{a(s).forEach(e=>D(e))}),j(()=>(g(),a(_)),()=>{g()&&y(_,[...a(_),{scan:g(),image:[]}])}),O(),ne();var M=we(),B=m(M);$(B,5,()=>a(s),b,(e,t)=>{var i=ge();let n;var v=m(i);o(i),k(h=>{n=re(i,1,"px-4 py-2 rounded shadow transition",null,n,h),X(v,`${a(t).device.label||"Unnamed Camera"} ${a(t).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(t).active,"bg-gray-800":!a(t).active,"text-white":!0})],te),Y("click",i,()=>G(a(t))),c(e,i)}),o(B);var T=w(B,2);$(T,5,()=>a(s),b,(e,t,i)=>{var n=R(),v=ae(n);{var h=x=>{var d=_e(),p=m(d);oe(p,(r,U)=>(U.videoEl=r,se(()=>a(s))),r=>r==null?void 0:r.videoEl,()=>[a(t)]),o(d),k(()=>fe(p,`transform: rotate(${a(t).rotation??""}deg);`)),Y("click",p,()=>F(a(t))),c(x,d)};Z(v,x=>{a(t).active&&x(h)})}c(e,n)}),o(T);var H=w(T,2);{var J=e=>{var t=me();$(t,5,()=>[...a(_)].reverse(),b,(i,n,v)=>{let h=()=>a(n).scan,x=()=>a(n).image;var d=xe(),p=m(d);C(p,"aria-label",`Delete scan ${v+1}`);var r=w(p,2),U=m(r,!0);o(r);var A=w(r,2);$(A,5,x,b,(N,Q)=>{var I=he();C(I,"alt",`Capture ${v+1}`),k(()=>C(I,"src",a(Q))),c(N,I)}),o(A);var K=w(A,2);C(K,"aria-label",`Confirm scan ${v+1}`),o(d),k(()=>X(U,h())),c(i,d)}),o(t),c(e,t)};Z(H,e=>{a(_).length&&e(J)})}o(M),c(l,M),ee(),E()}export{Ie as component,Ae as universal};
