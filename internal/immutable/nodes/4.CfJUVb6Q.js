import{t as _,a as d,c as F}from"../chunks/Cft7UBh8.js";import"../chunks/Bxi_qzrc.js";import{_ as G,a0 as J,a1 as K,a2 as N,Y as g,X as m,s as h,m as U,g as a,Z as n,W as L,n as Q,a3 as V,a4 as j,a5 as O}from"../chunks/BG6gY3H4.js";import{s as B,e as ee}from"../chunks/bN43d0cV.js";import{i as S}from"../chunks/BLL-_CAY.js";import{e as E,i as C,s as te,a as x}from"../chunks/CE6Nn08N.js";import{b as ae}from"../chunks/DlQWco9I.js";import{i as se}from"../chunks/DcRT1KMy.js";import{s as ie,a as re}from"../chunks/C27vTAZB.js";import{o as oe,a as ne}from"../chunks/DTXHACNF.js";import{s as le}from"../chunks/BN4M0NEs.js";const ve=!0,Ce=Object.freeze(Object.defineProperty({__proto__:null,prerender:ve},Symbol.toStringTag,{value:"Module"}));var de=_("<button> </button>"),ce=_('<video autoplay playsinline="" class="rounded shadow max-w-full"></video>',2),pe=_('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"><img class="h-24 rounded"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),ue=_('<div class="w-full flex flex-col gap-2 mt-6"></div>'),fe=_('<section class="flex flex-col items-center gap-4 p-4"><div class="flex flex-wrap justify-center gap-2"></div> <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mt-4"></div> <!></section>');function De(T,W){G(W,!1);const[q,z]=ie(),w=()=>re(le,"$scanner",q);let i=U([]),c=U([]),D=[];const H=async(e,t=3840,s=2160)=>{e.active||(e.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e.device.deviceId},width:{ideal:t},height:{ideal:s}},audio:!1}),e.active=!0,h(i,[...a(i)]),await O(),e.videoEl&&(e.videoEl.srcObject=e.stream))},P=e=>{e.active?M(e):H(e),h(i,[...a(i)])},M=e=>{var t;(t=e.stream)==null||t.getTracks().forEach(s=>s.stop()),e.stream=null,e.active=!1,e.videoEl&&(e.videoEl.srcObject=null)},R=e=>{if(!e)return null;const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;const s=t.getContext("2d");return s?(s.drawImage(e,0,0),t.toDataURL("image/png")):null};oe(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),D=(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput"),h(i,D.map(t=>({device:t,stream:null,videoEl:null,active:!1})))}),ne(()=>{a(i).forEach(e=>M(e))}),J(()=>(w(),a(c),a(i)),()=>{w()&&h(c,[...a(c),...a(i).filter(e=>e.active).map(e=>({scan:w(),image:R(e.videoEl)}))])}),K(),se();var b=fe(),y=g(b);E(y,5,()=>a(i),C,(e,t)=>{var s=de();let r;var l=g(s);n(s),L(p=>{r=te(s,1,"px-4 py-2 rounded shadow transition",null,r,p),B(l,`${a(t).device.label||"Unnamed Camera"} ${a(t).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(t).active,"bg-gray-800":!a(t).active,"text-white":!0})],Q),ee("click",s,()=>P(a(t))),d(e,s)}),n(y);var k=m(y,2);E(k,5,()=>a(i),C,(e,t,s)=>{var r=F(),l=V(r);{var p=u=>{var v=ce();ae(v,(o,f)=>(f.videoEl=o,j(()=>a(i))),o=>o==null?void 0:o.videoEl,()=>[a(t)]),d(u,v)};S(l,u=>{a(t).active&&u(p)})}d(e,r)}),n(k);var X=m(k,2);{var Y=e=>{var t=ue();E(t,5,()=>[...a(c)].reverse(),C,(s,r,l)=>{let p=()=>a(r).scan,u=()=>a(r).image;var v=pe(),o=g(v);x(o,"aria-label",`Delete scan ${l+1}`);var f=m(o,2),Z=g(f,!0);n(f);var $=m(f,2),I=g($);x(I,"alt",`Capture ${l+1}`),n($);var A=m($,2);x(A,"aria-label",`Confirm scan ${l+1}`),n(v),L(()=>{B(Z,p()),x(I,"src",u())}),d(s,v)}),n(t),d(e,t)};S(X,e=>{a(c).length&&e(Y)})}n(b),d(T,b),N(),z()}export{De as component,Ce as universal};
