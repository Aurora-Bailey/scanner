import{t as g,a as p,c as Q}from"../chunks/BdhtFqiG.js";import"../chunks/QcEuE8WI.js";import{B as S,a0 as V,a3 as j,a4 as O,a2 as ee,X as f,Y as w,s as y,m as W,g as a,Z as v,W as b,n as te,a1 as ae,a5 as se}from"../chunks/B5NlVW1R.js";import{s as q,e as z}from"../chunks/DJTxqxkt.js";import{i as H}from"../chunks/DHLh3Go0.js";import{t as ie,e as k,i as $,s as re,a as C}from"../chunks/CjwCq3FR.js";import{b as oe}from"../chunks/CIm7nDxW.js";import{i as ne}from"../chunks/CscDqrFY.js";import{s as le,a as ve}from"../chunks/BQhsLa98.js";import{o as de,a as ce}from"../chunks/BNhw6wZP.js";import{s as pe}from"../chunks/CmzvRsKH.js";function ue(d,h,T,E){var _=d.__style;if(S||_!==h){var r=ie(h);(!S||r!==d.getAttribute("style"))&&(r==null?d.removeAttribute("style"):d.style.cssText=r),d.__style=h}return E}const fe=!0,Le=Object.freeze(Object.defineProperty({__proto__:null,prerender:fe},Symbol.toStringTag,{value:"Module"}));var ge=g("<button> </button>"),he=g('<div><video autoplay playsinline="" class="rounded shadow transition-transform duration-300 cursor-pointer"></video></div>',2),_e=g('<img class="h-24 rounded">'),me=g('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),xe=g('<div class="w-full flex flex-col gap-2 mt-6"></div>'),we=g('<section class="flex flex-col items-center gap-4 p-4"><span>v1</span> <div class="flex flex-wrap justify-center gap-2"></div> <div class="flex items-center justify-between gap-4 p-4 text-lg rounded shadow"></div> <!></section>');function Te(d,h){V(h,!1);const[T,E]=le(),_=()=>ve(pe,"$scanner",T);let r=W([]),m=W([]),A=[];const R=e=>{e.rotation=(e.rotation+90)%360,y(r,[...a(r)])},X=async(e,t=3840,s=2160)=>{e.active||(e.landscape||([t,s]=[s,t]),e.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e.device.deviceId},width:{ideal:t},height:{ideal:s}},audio:!1}),e.active=!0)},Y=async e=>{e.active?P(e):X(e),y(r,[...a(r)])},P=e=>{var t;(t=e.stream)==null||t.getTracks().forEach(s=>s.stop()),e.stream=null,e.active=!1,e.videoEl&&(e.videoEl.srcObject=null)},Z=(e,t=0)=>{if(!e)return null;const s=e.videoWidth,o=e.videoHeight,i=document.createElement("canvas"),n=i.getContext("2d");return t%180===0?(i.width=s,i.height=o):(i.width=o,i.height=s),n?(n.save(),n.translate(i.width/2,i.height/2),n.rotate(t*Math.PI/180),n.drawImage(e,-s/2,-o/2),n.restore(),i.toDataURL("image/png")):null};de(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),A=(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput"),y(r,A.map(t=>({device:t,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),ce(()=>{a(r).forEach(e=>P(e))}),j(()=>(_(),a(r),a(m)),()=>{if(_()){const e=a(r).filter(t=>t.active&&t.videoEl).map(t=>Z(t.videoEl,t.rotation));y(m,[...a(m),{scan:_(),image:[...e]}])}}),O(),ne();var D=we(),M=f(w(D),2);k(M,5,()=>a(r),$,(e,t)=>{var s=ge();let o;var i=w(s);v(s),b(n=>{o=re(s,1,"px-4 py-2 rounded shadow transition",null,o,n),q(i,`${a(t).device.label||"Unnamed Camera"} ${a(t).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(t).active,"bg-gray-800":!a(t).active,"text-white":!0})],te),z("click",s,()=>Y(a(t))),p(e,s)}),v(M);var I=f(M,2);k(I,5,()=>a(r),$,(e,t,s)=>{var o=Q(),i=ae(o);{var n=x=>{var c=he(),u=w(c);oe(u,(l,U)=>(U.videoEl=l,se(()=>a(r))),l=>l==null?void 0:l.videoEl,()=>[a(t)]),v(c),b(()=>ue(u,`transform: rotate(${a(t).rotation??""}deg);`)),z("click",u,()=>R(a(t))),p(x,c)};H(i,x=>{a(t).active&&x(n)})}p(e,o)}),v(I);var F=f(I,2);{var G=e=>{var t=xe();k(t,5,()=>[...a(m)].reverse(),$,(s,o,i)=>{let n=()=>a(o).scan,x=()=>a(o).image;var c=me(),u=w(c);C(u,"aria-label",`Delete scan ${i+1}`);var l=f(u,2),U=w(l,!0);v(l);var B=f(l,2);k(B,5,x,$,(K,N)=>{var L=_e();C(L,"alt",`Capture ${i+1}`),b(()=>C(L,"src",a(N))),p(K,L)}),v(B);var J=f(B,2);C(J,"aria-label",`Confirm scan ${i+1}`),v(c),b(()=>q(U,n())),p(s,c)}),v(t),p(e,t)};H(F,e=>{a(m).length&&e(G)})}v(D),p(d,D),ee(),E()}export{Te as component,Le as universal};
