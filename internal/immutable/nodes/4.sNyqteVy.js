import{t as f,a as p,c as N}from"../chunks/BdhtFqiG.js";import"../chunks/QcEuE8WI.js";import{B as P,a0 as Q,a3 as V,a4 as O,a2 as ee,Y as x,X as w,s as b,m as S,g as a,Z as c,W as y,n as te,a1 as ae,a5 as se}from"../chunks/B5NlVW1R.js";import{s as W,e as q}from"../chunks/DJTxqxkt.js";import{i as z}from"../chunks/DHLh3Go0.js";import{t as re,e as k,i as $,s as ie,a as C}from"../chunks/CjwCq3FR.js";import{b as oe}from"../chunks/CIm7nDxW.js";import{i as ne}from"../chunks/CscDqrFY.js";import{s as le,a as ce}from"../chunks/BQhsLa98.js";import{o as ve,a as de}from"../chunks/BNhw6wZP.js";import{s as pe}from"../chunks/CmzvRsKH.js";function ue(v,g,T,E){var h=v.__style;if(P||h!==g){var r=re(g);(!P||r!==v.getAttribute("style"))&&(r==null?v.removeAttribute("style"):v.style.cssText=r),v.__style=g}return E}const fe=!0,Le=Object.freeze(Object.defineProperty({__proto__:null,prerender:fe},Symbol.toStringTag,{value:"Module"}));var ge=f("<button> </button>"),he=f('<div><video autoplay playsinline="" class="rounded shadow transition-transform duration-300 cursor-pointer"></video></div>',2),me=f('<img class="h-24 rounded">'),_e=f('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),xe=f('<div class="w-full flex flex-col gap-2 mt-6"></div>'),we=f('<section class="flex flex-col items-center gap-4 p-4"><div class="flex flex-wrap justify-center gap-2"></div> <div class="flex items-center justify-between gap-4 p-4 text-lg rounded shadow"></div> <!></section>');function Te(v,g){Q(g,!1);const[T,E]=le(),h=()=>ce(pe,"$scanner",T);let r=S([]),m=S([]),U=[];const H=t=>{t.rotation=(t.rotation+90)%360,b(r,[...a(r)])},R=async(t,e=3840,i=2160)=>{},X=async t=>{t.active?A(t):R(),b(r,[...a(r)])},A=t=>{var e;(e=t.stream)==null||e.getTracks().forEach(i=>i.stop()),t.stream=null,t.active=!1,t.videoEl&&(t.videoEl.srcObject=null)},Y=(t,e=0)=>{if(!t)return null;const i=t.videoWidth,o=t.videoHeight,s=document.createElement("canvas"),n=s.getContext("2d");return e%180===0?(s.width=i,s.height=o):(s.width=o,s.height=i),n?(n.save(),n.translate(s.width/2,s.height/2),n.rotate(e*Math.PI/180),n.drawImage(t,-i/2,-o/2),n.restore(),s.toDataURL("image/png")):null};ve(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),U=(await navigator.mediaDevices.enumerateDevices()).filter(e=>e.kind==="videoinput"),b(r,U.map(e=>({device:e,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),de(()=>{a(r).forEach(t=>A(t))}),V(()=>(h(),a(r),a(m)),()=>{if(h()){const t=a(r).filter(e=>e.active&&e.videoEl).map(e=>Y(e.videoEl,e.rotation));b(m,[...a(m),{scan:h(),image:[...t]}])}}),O(),ne();var D=we(),M=x(D);k(M,5,()=>a(r),$,(t,e)=>{var i=ge();let o;var s=x(i);c(i),y(n=>{o=ie(i,1,"px-4 py-2 rounded shadow transition",null,o,n),W(s,`${a(e).device.label||"Unnamed Camera"} ${a(e).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(e).active,"bg-gray-800":!a(e).active,"text-white":!0})],te),q("click",i,()=>X(a(e))),p(t,i)}),c(M);var j=w(M,2);k(j,5,()=>a(r),$,(t,e,i)=>{var o=N(),s=ae(o);{var n=_=>{var d=he(),u=x(d);oe(u,(l,B)=>(B.videoEl=l,se(()=>a(r))),l=>l==null?void 0:l.videoEl,()=>[a(e)]),c(d),y(()=>ue(u,`transform: rotate(${a(e).rotation??""}deg);`)),q("click",u,()=>H(a(e))),p(_,d)};z(s,_=>{a(e).active&&_(n)})}p(t,o)}),c(j);var Z=w(j,2);{var F=t=>{var e=xe();k(e,5,()=>[...a(m)].reverse(),$,(i,o,s)=>{let n=()=>a(o).scan,_=()=>a(o).image;var d=_e(),u=x(d);C(u,"aria-label",`Delete scan ${s+1}`);var l=w(u,2),B=x(l,!0);c(l);var I=w(l,2);k(I,5,_,$,(J,K)=>{var L=me();C(L,"alt",`Capture ${s+1}`),y(()=>C(L,"src",a(K))),p(J,L)}),c(I);var G=w(I,2);C(G,"aria-label",`Confirm scan ${s+1}`),c(d),y(()=>W(B,n())),p(i,d)}),c(e),p(t,e)};z(Z,t=>{a(m).length&&t(F)})}c(D),p(v,D),ee(),E()}export{Te as component,Le as universal};
