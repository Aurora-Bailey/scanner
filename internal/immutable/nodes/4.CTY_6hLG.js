import{t as w,a as D}from"../chunks/Mteb8VqS.js";import"../chunks/CO40t61u.js";import{C as $,E as y,F as x,G as M,s as m,m as f,g as r}from"../chunks/BNOmpQgF.js";import{i as C}from"../chunks/D5aK_Tzc.js";import{s as I,a as k}from"../chunks/CPxwGAB2.js";import{o as P,a as S}from"../chunks/DLWCSaku.js";import{s as T}from"../chunks/ByJiUqdi.js";const U=!0,q=Object.freeze(Object.defineProperty({__proto__:null,prerender:U},Symbol.toStringTag,{value:"Module"}));var b=w('<section class="flex flex-col items-center gap-4 p-4"></section>');function A(u,g){$(g,!1);const[d,v]=I(),n=()=>k(T,"$scanner",d);let i=f([]),c=f([]),p=[];const h=t=>{var e;(e=t.stream)==null||e.getTracks().forEach(o=>o.stop()),t.stream=null,t.active=!1,t.videoEl&&(t.videoEl.srcObject=null)},_=(t,e=0)=>{if(!t)return null;const o=t.videoWidth,l=t.videoHeight,a=document.createElement("canvas"),s=a.getContext("2d");return e%180===0?(a.width=o,a.height=l):(a.width=l,a.height=o),s?(s.save(),s.translate(a.width/2,a.height/2),s.rotate(e*Math.PI/180),s.drawImage(t,-o/2,-l/2),s.restore(),a.toDataURL("image/png")):null};P(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),p=(await navigator.mediaDevices.enumerateDevices()).filter(e=>e.kind==="videoinput"),m(i,p.map(e=>({device:e,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),S(()=>{r(i).forEach(t=>h(t))}),y(()=>(n(),r(i),r(c)),()=>{if(n()){const t=r(i).filter(e=>e.active&&e.videoEl).map(e=>_(e.videoEl,e.rotation)).filter(e=>!!e);m(c,[...r(c),{scan:n(),image:t}])}}),x(),C();var E=b();D(u,E),M(),v()}export{A as component,q as universal};
