import{t as f,a as p,c as K}from"../chunks/BdhtFqiG.js";import"../chunks/QcEuE8WI.js";import{B as A,a0 as N,a3 as Q,a4 as V,a2 as O,Y as x,X as b,s as w,m as P,g as a,Z as v,W as y,n as ee,a1 as te,a5 as ae}from"../chunks/B5NlVW1R.js";import{s as S,e as W}from"../chunks/DJTxqxkt.js";import{i as q}from"../chunks/DHLh3Go0.js";import{t as se,e as k,i as $,s as re,a as E}from"../chunks/CjwCq3FR.js";import{b as ie}from"../chunks/CIm7nDxW.js";import{i as oe}from"../chunks/CscDqrFY.js";import{s as ne,a as le}from"../chunks/BQhsLa98.js";import{o as ve,a as ce}from"../chunks/BNhw6wZP.js";import{s as de}from"../chunks/CmzvRsKH.js";function pe(c,g,T,C){var m=c.__style;if(A||m!==g){var r=se(g);(!A||r!==c.getAttribute("style"))&&(r==null?c.removeAttribute("style"):c.style.cssText=r),c.__style=g}return C}const ue=!0,Ie=Object.freeze(Object.defineProperty({__proto__:null,prerender:ue},Symbol.toStringTag,{value:"Module"}));var fe=f("<button> </button>"),ge=f('<div><video autoplay playsinline="" class="rounded shadow transition-transform duration-300 cursor-pointer"></video></div>',2),me=f('<img class="h-24 rounded">'),_e=f('<div class="flex items-center justify-between gap-4 p-4 bg-cyan-600 text-lg rounded shadow"><button class="text-white hover:text-red-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button> <span class="flex-1 text-white truncate"> </span> <div class="flex gap-1"></div> <button class="hover:text-lime-400 transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></button></div>'),he=f('<div class="w-full flex flex-col gap-2 mt-6"></div>'),xe=f('<section class="flex flex-col items-center gap-4 p-4"><div class="flex flex-wrap justify-center gap-2"></div> <div class="flex items-center justify-between gap-4 p-4 text-lg rounded shadow"></div> <!></section>');function Le(c,g){N(g,!1);const[T,C]=ne(),m=()=>le(de,"$scanner",T);let r=P([]),_=P([]),U=[];const z=t=>{t.rotation=(t.rotation+90)%360,w(r,[...a(r)])},H=t=>{w(r,[...a(r)])},R=t=>{var e;(e=t.stream)==null||e.getTracks().forEach(i=>i.stop()),t.stream=null,t.active=!1,t.videoEl&&(t.videoEl.srcObject=null)},X=(t,e=0)=>{if(!t)return null;const i=t.videoWidth,o=t.videoHeight,s=document.createElement("canvas"),n=s.getContext("2d");return e%180===0?(s.width=i,s.height=o):(s.width=o,s.height=i),n?(n.save(),n.translate(s.width/2,s.height/2),n.rotate(e*Math.PI/180),n.drawImage(t,-i/2,-o/2),n.restore(),s.toDataURL("image/png")):null};ve(async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),U=(await navigator.mediaDevices.enumerateDevices()).filter(e=>e.kind==="videoinput"),w(r,U.map(e=>({device:e,stream:null,videoEl:null,active:!1,rotation:0,landscape:!0})))}),ce(()=>{a(r).forEach(t=>R(t))}),Q(()=>(m(),a(r),a(_)),()=>{if(m()){const t=a(r).filter(e=>e.active&&e.videoEl).map(e=>X(e.videoEl,e.rotation));w(_,[...a(_),{scan:m(),image:[...t]}])}}),V(),oe();var D=xe(),M=x(D);k(M,5,()=>a(r),$,(t,e)=>{var i=fe();let o;var s=x(i);v(i),y(n=>{o=re(i,1,"px-4 py-2 rounded shadow transition",null,o,n),S(s,`${a(e).device.label||"Unnamed Camera"} ${a(e).active?"ðŸŸ¢":"âšª"}`)},[()=>({"bg-green-700":a(e).active,"bg-gray-800":!a(e).active,"text-white":!0})],ee),W("click",i,()=>H(a(e))),p(t,i)}),v(M);var j=b(M,2);k(j,5,()=>a(r),$,(t,e,i)=>{var o=K(),s=te(o);{var n=h=>{var d=ge(),u=x(d);ie(u,(l,B)=>(B.videoEl=l,ae(()=>a(r))),l=>l==null?void 0:l.videoEl,()=>[a(e)]),v(d),y(()=>pe(u,`transform: rotate(${a(e).rotation??""}deg);`)),W("click",u,()=>z(a(e))),p(h,d)};q(s,h=>{a(e).active&&h(n)})}p(t,o)}),v(j);var Y=b(j,2);{var Z=t=>{var e=he();k(e,5,()=>[...a(_)].reverse(),$,(i,o,s)=>{let n=()=>a(o).scan,h=()=>a(o).image;var d=_e(),u=x(d);E(u,"aria-label",`Delete scan ${s+1}`);var l=b(u,2),B=x(l,!0);v(l);var I=b(l,2);k(I,5,h,$,(G,J)=>{var L=me();E(L,"alt",`Capture ${s+1}`),y(()=>E(L,"src",a(J))),p(G,L)}),v(I);var F=b(I,2);E(F,"aria-label",`Confirm scan ${s+1}`),v(d),y(()=>S(B,n())),p(i,d)}),v(e),p(t,e)};q(Y,t=>{a(_).length&&t(Z)})}v(D),p(c,D),O(),C()}export{Le as component,Ie as universal};
